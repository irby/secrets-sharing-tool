[![Main Quality](https://github.com/irby/secrets-sharing-tool/actions/workflows/main.yml/badge.svg?branch=main)](https://github.com/irby/secrets-sharing-tool/actions/workflows/main.yml)

# Secrets Sharing Tool

## Description
This is a tool that will allow users to be able to easily and securely share secrets. To ensure security, secrets are stored encrypted, the key used to decrypt is never stored, and the secret can only be retrieved once and must be done before the secret expires. This is useful if you want to share sensitive information such as credentials without worrying about them being able to be read by an unwanted party. 

The encryption schemes used are as follows:
- The [Rijndael algorithm](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rijndael?view=net-5.0) is used to encrypt the message
- [RSA](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsa?view=net-5.0) is used to encrypt the key generated by the Rijandael algorithm
- [SHA-512/RSA](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsapkcs1signatureformatter?view=net-5.0) is used to hash the encrypted message to ensure it was not modified

Once a secret is created, it will produce an ID, a key, and an expire datetime. The ID and key are to be used to decrypt the message. The key is never stored, so if this is lost then the message will *not* be recoverable. The expire datetime indicates when the secret will expire; the secret will not be decrypted once the expire datetime has passed. 

## Usage

### Secret Creation

To create a secret, make the following call:

```
POST /api/secrets

{
    "message": "Hello world!",
    "secondsToLive": 60
}
```

This will encrypt the message `Hello world!` and will give the secret a lifespan of 60 seconds. 

An example response body is below:
```
201 Created
{
    "id": "8f826f5c-6951-41ee-987e-7556dc03d777",
    "key": "MIICXQIBAAKBgQDLL3OZ12sj96oqOXim90Qjh3dG2aRIUf01WgHl0ckd68Ze7UFO3yF/XluQvZg4xV3q35svH7OcYxjiP5pewTxLMcPT38UtJvavNTrFIYAa+XVzoslae+a/ZByue03QrINQyDRAMu7ezj/HVPudHra43sELsqFxcZsTDJPjkf8fZwIDAQABAoGAUsWv6DoTkYFxNuZWul38yiSDeL9s53FPH47dOwxtS90i4MTyV/kaIlMEJkC2ZFoy2l3hUB8wAkN0faa/cl5x+s3bKY4T+qflh7LYC93jNOL1CxOtU5AEkaUc0Gottpz8LwscQV0NMyJX4VkXlDs6Jttz6BgZbzSpX2VmZ9MA5oECQQDxT3v0L5z8gxjY3ug66OMuZfqKWtkcToo3YqIU+aXllB5TnVlrIQuDaL0rXbBXYrUi6WVbJpJL31HQBN8x5tjHAkEA143WAA0R8OEEkfFwuKZ+tbxbiTrKgN2/mcjbpB4KawJV/3+iehxWDHcUICJj4dPohlR2CJuJnW8BjOUct50kYQJBANaGCPYeVfuOOEqkb+PfIggflMnm1dh6Yhm2z8zB25/rO8Ktwc6hQ/EA7htdYOVu1QVCZF7SPYDB+aNqkVl1lgUCQQCoCl/BjG7nHVSlvdaFbO6tGRk3I0kJK1YaOlbYW779a0XFuCffEEYY06Ax6P166OuGBUQ7M54VyJspztcTYYMhAkAbAsbBrHcW8RJW65763Z8ViYoeHaza3IIuZzryDwF+op7gqC5UnLWZxoL57GnhFzHu11dudBui83VHQan649kQ",
    "expireDateTime": "2021-09-13T14:48:01.665844Z"
}
```

Note: The `expireDateTime` value is in UTC time. 


### Secret Retrieval

To retrieve a secret, make the following call:

```
GET /api/secrets/{id}?key={key}
```

Following the example above, the call would look like this:

```
GET /api/secrets/8f826f5c-6951-41ee-987e-7556dc03d777?key=MIICXQIBAAKBgQDLL3OZ12sj96oqOXim90Qjh3dG2aRIUf01WgHl0ckd68Ze7UFO3yF/XluQvZg4xV3q35svH7OcYxjiP5pewTxLMcPT38UtJvavNTrFIYAa+XVzoslae+a/ZByue03QrINQyDRAMu7ezj/HVPudHra43sELsqFxcZsTDJPjkf8fZwIDAQABAoGAUsWv6DoTkYFxNuZWul38yiSDeL9s53FPH47dOwxtS90i4MTyV/kaIlMEJkC2ZFoy2l3hUB8wAkN0faa/cl5x+s3bKY4T+qflh7LYC93jNOL1CxOtU5AEkaUc0Gottpz8LwscQV0NMyJX4VkXlDs6Jttz6BgZbzSpX2VmZ9MA5oECQQDxT3v0L5z8gxjY3ug66OMuZfqKWtkcToo3YqIU+aXllB5TnVlrIQuDaL0rXbBXYrUi6WVbJpJL31HQBN8x5tjHAkEA143WAA0R8OEEkfFwuKZ+tbxbiTrKgN2/mcjbpB4KawJV/3+iehxWDHcUICJj4dPohlR2CJuJnW8BjOUct50kYQJBANaGCPYeVfuOOEqkb+PfIggflMnm1dh6Yhm2z8zB25/rO8Ktwc6hQ/EA7htdYOVu1QVCZF7SPYDB+aNqkVl1lgUCQQCoCl/BjG7nHVSlvdaFbO6tGRk3I0kJK1YaOlbYW779a0XFuCffEEYY06Ax6P166OuGBUQ7M54VyJspztcTYYMhAkAbAsbBrHcW8RJW65763Z8ViYoeHaza3IIuZzryDwF+op7gqC5UnLWZxoL57GnhFzHu11dudBui83VHQan649kQ
```

If the secret retrieval is successful, the response body should be:

```
200 OK
{
    "message": "Hello world!"
}
```

If the secret retrieval is *not* successful, the response body will be:

```
422 Unprocessable Entity
{
    "message": "Resource was either not found or expired, or the key provided may not be correct"
}
```

A secret retrieval may fail if either of the following scenarios occur:
- The secret with the ID provided does not exist
- The secret has already been retrieved
- The secret has expired
- The number of allowed attempts to access the secret has been hit
- The key provided is incorrect
- The stored message was modified

